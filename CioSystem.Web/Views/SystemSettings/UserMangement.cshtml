@model List<CioSystem.Models.UserViewModel>

@{
    ViewData["Title"] = "用戶管理";
}

<div class="container-fluid">
    <!-- 頁面標題 -->
    <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
        <h1 class="h2 modern-title">
            <i class="fas fa-users text-info"></i> 用戶管理
        </h1>
        <div class="btn-toolbar mb-2 mb-md-0">
            <div class="btn-group me-2">
                <button type="button" class="btn btn-success" onclick="showAddUserDialog()">
                    <i class="fas fa-plus"></i> 新增用戶
                </button>
                <a asp-action="Index" class="btn btn-outline-secondary">
                    <i class="fas fa-arrow-left"></i> 返回
                </a>
            </div>
        </div>
    </div>

    <!-- 用戶列表 -->
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-list me-2"></i>用戶列表
                    </h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead class="table-dark">
                                <tr>
                                    <th>ID</th>
                                    <th>用戶名</th>
                                    <th>信箱</th>
                                    <th>角色</th>
                                    <th>狀態</th>
                                    <th>最後登入</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                @if (Model != null && Model.Any())
                                {
                                    @foreach (var user in Model)
                                    {
                                        <tr>
                                            <td>@user.Id</td>
                                            <td>
                                                <div class="d-flex align-items-center">
                                                    <div class="avatar-sm bg-primary text-white rounded-circle d-flex align-items-center justify-content-center me-2">
                                                        @user.Username.Substring(0, 1).ToUpper()
                                                    </div>
                                                    @user.Username
                                                </div>
                                            </td>
                                            <td>@user.Email</td>
                                            <td>
                                                <span class="badge @(user.Role == "管理員" ? "bg-danger" : user.Role == "經理" ? "bg-warning" : "bg-info")">
                                                    @user.Role
                                                </span>
                                            </td>
                                            <td>
                                                <span class="badge @(user.IsActive ? "bg-success" : "bg-secondary")">
                                                    @(user.IsActive ? "啟用" : "停用")
                                                </span>
                                            </td>
                                            <td>@(user.LastLogin?.ToString("yyyy-MM-dd HH:mm") ?? "從未登入")</td>
                                            <td>
                                                <div class="btn-group" role="group">
                                                    <button type="button" class="btn btn-sm btn-outline-primary" onclick="editUser(@user.Id)">
                                                        <i class="fas fa-edit"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-sm btn-outline-warning" onclick="resetPassword(@user.Id)">
                                                        <i class="fas fa-key"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-sm btn-outline-danger" onclick="deleteUser(@user.Id)">
                                                        <i class="fas fa-trash"></i>
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    }
                                }
                                else
                                {
                                    <tr>
                                        <td colspan="7" class="text-center text-muted">
                                            <i class="fas fa-users fa-2x mb-3"></i>
                                            <br>暫無用戶資料
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 角色統計 -->
    <div class="row mt-4">
        <div class="col-md-4">
            <div class="card text-center">
                <div class="card-body">
                    <i class="fas fa-crown fa-2x text-danger mb-2"></i>
                    <h5 class="card-title">管理員</h5>
                    <h3 class="text-danger">1</h3>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card text-center">
                <div class="card-body">
                    <i class="fas fa-user-tie fa-2x text-warning mb-2"></i>
                    <h5 class="card-title">經理</h5>
                    <h3 class="text-warning">1</h3>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card text-center">
                <div class="card-body">
                    <i class="fas fa-user fa-2x text-info mb-2"></i>
                    <h5 class="card-title">員工</h5>
                    <h3 class="text-info">1</h3>
                </div>
            </div>
        </div>
    </div>
</div>

<script>function showAddUserDialog() {
        alert('新增用戶功能開發中...');
    }

    function editUser(userId) {
        alert('編輯用戶功能開發中... ID: ' + userId);
    }

    function resetPassword(userId) {
        if (confirm('確定要重設此用戶的密碼嗎？')) {
            alert('重設密碼功能開發中... ID: ' + userId);
        }
    }

    function deleteUser(userId) {
        if (confirm('確定要刪除此用戶嗎？此操作無法復原！')) {
            alert('刪除用戶功能開發中... ID: ' + userId);
        }
    }</script>

<style>
    .modern-title {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        font-weight: 600;
    }

    .card {
        transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        border: none;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
        }

    .card-header {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        border-bottom: 1px solid #dee2e6;
    }

    .avatar-sm {
        width: 32px;
        height: 32px;
        font-size: 14px;
        font-weight: bold;
    }

    .btn {
        transition: all 0.3s ease;
    }

        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
</style>